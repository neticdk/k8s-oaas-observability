checks:
  # reliability
  deploymentMissingReplicas: ignore
  priorityClassNotSet: warning
  tagNotSpecified: danger
  pullPolicyNotAlways: warning
  readinessProbeMissing: warning
  livenessProbeMissing: warning
  metadataAndNameMismatched: ignore
  pdbDisruptionsIsZero: warning
  missingPodDisruptionBudget: ignore
  topologySpreadConstraint: warning

  # efficiency
  cpuRequestsMissing: warning
  cpuLimitsMissing: ignore
  memoryRequestsMissing: warning
  memoryLimitsMissing: warning

  # security
  automountServiceAccountToken: warning
  hostIPCSet: danger
  hostPIDSet: danger
  linuxHardening: warning
  missingNetworkPolicy: warning
  notReadOnlyRootFilesystem: warning
  privilegeEscalationAllowed: danger
  runAsRootAllowed: danger
  runAsPrivileged: danger
  dangerousCapabilities: danger
  insecureCapabilities: warning
  hostNetworkSet: danger
  hostPortSet: warning
  tlsSettingsMissing: warning
  sensitiveContainerEnvVar: danger
  sensitiveConfigmapContent: danger
  clusterrolePodExecAttach: danger
  rolePodExecAttach: danger
  clusterrolebindingPodExecAttach: danger
  rolebindingClusterRolePodExecAttach: danger
  rolebindingRolePodExecAttach: danger
  clusterrolebindingClusterAdmin: danger
  rolebindingClusterAdminClusterRole: danger
  rolebindingClusterAdminRole: danger

exemptions:
  - controllerNames:
      - charts/prometheus-node-exporter
      - charts/oaas-observability-prometheus-node-exporter
    rules:
      - hostPIDSet
      - hostNetworkSet
  - controllerNames:
      - charts/oaas-observability-vector-agent
    rules:
      - runAsRootAllowed
  - controllerNames:
      - charts/oaas-observability-test
      - charts/oaas-observability-prometheus-operator-admission-patch
      - charts/oaas-observability-prometheus-operator-admission-create
      - charts/oaas-observability-opentelemetry-operator-cert-manager # OpenTelemetry Operator chart test
      - charts/oaas-observability-opentelemetry-operator-metrics      # OpenTelemetry Operator chart test
      - charts/oaas-observability-opentelemetry-operator-webhook      # OpenTelemetry Operator chart test
      - opentelemetry-operator-cert-manager-test-connection
      - opentelemetry-operator-controller-manager-metrics-test-connection
      - opentelemetry-operator-webhook-test-connection
